<!DOCTYPE html>
{% autoescape true %}
<html>
  <!-- [START head_html] -->
  <head>
        <title>Post Up Now</title>
    <link rel="icon" 
          type="image/png" 
          href="/static/miniLogo.png">
        <script src = "http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <link href = "/stylesheets/bootstrap.css" rel="stylesheet">
        <script src = "http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <!-- <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>-->
        <style>
              #map_wrapper {
                  height: 400px;
              }

              #map_canvas {
                  width: 50%;
                  height: 100%;
              }

    input[type="radio"]{
        vertical-align: baseline;
    }

            </style>
            <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDIHMXMSGcPXudNOBZXra8qpA9xs38UKQQ">
    </script>
      <script>
// The following example creates complex markers to indicate beaches near
// Sydney, NSW, Australia. Note that the anchor is set to
// (0,32) to correspond to the base of the flagpole.

function initialize() {
  var lat = 37.777994;
  var lng = -122.272465;

  var mapOptions = {
    center: new google.maps.LatLng(lat, lng),
    zoom: 12
  };
  var map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

  setMarkers(map, businesses);
}

 //fields: name, address, city, zip, status
var businesses = [
    ['christinas house', '1975 Constitution Way', 1]

];

function setMarkers(map, locations) {
  // Add markers to the map

  // Marker sizes are expressed as a Size of X,Y
  // where the origin of the image (0,0) is located
  // in the top left of the image.

  // Origins, anchor positions and coordinates of the marker
  // increase in the X direction to the right and in
  // the Y direction down.
  var image = {
    url: 'pin.png',
    // This marker is 20 pixels wide by 32 pixels tall.
    size: new google.maps.Size(50, 50),
    // The origin for this image is 0,0.
    origin: new google.maps.Point(0,0),
    // The anchor for this image is the base of the flagpole at 0,32.
    anchor: new google.maps.Point(25, 50)
  };
  var shape = {
      coords: [0, 0, 20, 20],
      type: 'rect'
  };
  for (var i = 0; i < locations.length; i++) {
    var beach = locations[i];
    
    var address = beach[1];
    geocoder = new google.maps.Geocoder();
    geocoder.geocode( { 'address': address}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      map.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location,
          icon: image,
          shape: shape,
          title: beach[0],
          //zIndex: beach[3]
      });
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
  }
}

google.maps.event.addDomListener(window, 'load', initialize);

</script>  
  </head>
  <!-- [END head_html] -->
  <body>
    <!--<a href="{{ url|safe }}">{{ url_linktext }}</a>-->
    <div id="wrap" class="navbar navbar-inverse"; style="background-color:white">
      <div class="navbar-inner"; style="background-color:white; border-top-width: 10px">
        <img src="/static/logo.png"; style="width:150px">
        <div class="container">
            <ul class="nav" style="clear:both">
             <li><a href="index.html">Home</a></li>
             <li><a href="about.html">About</a></li>
             <li><a href="contact.html">Contact Us</a></li>
             <li><a href="help.html">Help</a></li>
            </ul>
        </div>
      </div>
    </div>

    <div class="container">
    <!--
        <div class="hero-unit" style="background-image:url('/static/homepage.jpg'); width:620px; height: 400px; padding-top:40px">
            <h4 style="color:white"> Find stores nearby that sell what you want - close range, great prices. </h4>
                <div>
                  <form method="link" action = "other.html">
                  <input id="good" type="text" name="search" placeholder="Enter the good you want ..."> </input> 
                  <input id="place" type="text" name="place" placeholder="Enter your location..."> </input> 
                  <label style="color:white"><input type="radio" name="parameter" value="price"> Sort by price</label>
                  <label style="color:white"><input type="radio" name="parameter" value="distance"> Sort by distance </label>
    <input type="submit" value="Get Results">
    </form>
                </div>
                <div id="info" class=""> </div>
        </div>
        <div id="results" style="width:50%; float:left">  </div>
        <br>-->
    <div id="map_wrapper">
          <div id="map_canvas" class="mapping">
          
        </div>
    </div>
    </div>
    
  </body>
</html>
{% endautoescape %}
  

<script>
jQuery.ajaxSettings.traditional = true; 

var latitude; //my current lat
var longitude; //my current long

function getLocation()
{
  if (navigator.geolocation)
  {
    navigator.geolocation.getCurrentPosition(setPosition);
  }
  else
  {
    x.innerHTML="Geolocation is not supported by this browser.";
  }
}

function setPosition(position)
{
  latitude = position.coords.latitude;
  longitude = position.coords.longitude;
  var location = document.getElementById("place");
  var url = "http://api.geonames.org/findNearbyPostalCodes?lat="+latitude+"&lng="+longitude+"&username=lucasholucasho";
  $.ajax({
      type: "GET",
      url: url,
      dataType: "xml",
      success: function(data) {
        var city;
        var state;
          $(data).find("code").find("name").each(function()
          {
            city = $(this).text();
          });
          
          $(data).find("code").find("adminCode1").each(function()
          {
            state = $(this).text();
          });

         location.value = city+", "+state;
      }
    })
}

$(document).ready(function() {
  $.ajaxSetup({ cache: false });
  getLocation();
});

</script>